#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš€ Pre-push: Running comprehensive checks..."

# 1. Linting
echo "ğŸ§¹ Step 1/3: Linting..."
pnpm lint

if [ $? -ne 0 ]; then
  echo "âŒ Linting failed! Please fix the errors before pushing."
  exit 1
fi

# 2. Type checking (if available)
echo "ğŸ” Step 2/3: Type checking..."
if command -v tsc >/dev/null 2>&1; then
  pnpm exec tsc --noEmit
  if [ $? -ne 0 ]; then
    echo "âŒ Type checking failed! Please fix the errors before pushing."
    exit 1
  fi
else
  echo "âš ï¸  TypeScript not found, skipping type check..."
fi

# 3. Build check
echo "ğŸ”¨ Step 3/3: Building project..."
pnpm build

if [ $? -ne 0 ]; then
  echo "âŒ Build failed! Please fix the errors before pushing."
  exit 1
fi

echo "âœ… All checks passed! Proceeding with push..."
